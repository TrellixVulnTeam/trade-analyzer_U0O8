{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/benjaminshiao/Desktop/react/trade-analyzer/src/components/chart-components/Chart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport Candle from \"./Candle\";\nimport CrossHairs from \"./CrossHairs\";\n\nconst Chart = props => {\n  _s();\n\n  const {\n    data,\n    width: chart_width,\n    height: chart_height\n  } = props; // let { last_bar_idx = 0, bars_wide = 40 } = props;\n  // last_bar_idx should default to the last bar in the data, or else be sure passed-in value doesn't exceed the last bar\n  // last_bar_idx = last_bar_idx > 0 ? Math.min(last_bar_idx, data.length - 1) : data.length - 1;\n\n  const [mouseCoords, setMouseCoords] = useState({\n    x: -50,\n    y: -50\n  }); // let mouseCoords = {\n  //   x: 0,\n  //   y: 0\n  // };\n  // const setMouseCoords = (x, y) => {\n  //   mouseCoords = { x, y };\n  // };\n\n  /*\n  \n    const dollar_high = Math.max.apply(Math, data.map(bar => bar.high)) * 1;\n    const dollar_low = +data.map(bar => bar.low).sort()[0];\n    console.log(dollar_low, dollar_high, data.map(bar => bar.low).sort());\n  */\n  // find the high and low bounds of all the bars being sidplayed\n\n  const dollar_high = Math.max.apply(Math, data.map(bar => +bar.high)) * 1.5;\n  const dollar_low = Math.min.apply(Math, data.map(bar => +bar.low)) * 0.5;\n  console.log(dollar_low, dollar_high, data.map(bar => +bar.low).sort());\n  const chart_dims = {\n    pixel_width: chart_width,\n    pixel_height: chart_height,\n    dollar_high,\n    dollar_low,\n    dollar_delta: dollar_high - dollar_low\n  }; // toFixed rounds number to 2 decimal places\n\n  const dollarAt = pixel => {\n    const dollar = Math.abs(pixel - chart_dims.pixel_height) / chart_dims.pixel_height * chart_dims.dollar_delta + chart_dims.dollar_low;\n    return pixel > 0 ? dollar.toFixed(2) : \"-\";\n  }; // Gets candlestick data at x position\n\n\n  const candleDataAt = pixel => {\n    if (pixel <= 0 || pixel >= chart_dims.pixel_width) return \"-\";\n    const candle = data[Math.floor(pixel / chart_dims.pixel_width * data.length)];\n    return candle;\n  };\n\n  const candleChange = pixel => {\n    if (pixel <= 0 || pixel >= chart_dims.pixel_width) return \"-\";\n    const candle = data[Math.floor(pixel / chart_dims.pixel_width * data.length)];\n    const change = (candle['close'] / candle['open'] - 1) * 100;\n    const posNeg = change > 0 ? '+' : '-';\n    return posNeg + Math.abs(change).toFixed(2) + '%';\n  };\n\n  const pixelFor = dollar => {\n    return Math.abs((dollar - chart_dims[\"dollar_low\"]) / chart_dims[\"dollar_delta\"] * chart_dims[\"pixel_height\"] - chart_dims[\"pixel_height\"]);\n  };\n\n  const onMouseLeave = () => {\n    setMouseCoords({\n      x: -50,\n      y: -50\n    });\n  };\n\n  const onMouseMoveInside = e => {\n    //for date(x axis), calc using dates[x cord/width] , create dates[]\n    setMouseCoords({\n      x: e.nativeEvent.x - Math.round(e.currentTarget.getBoundingClientRect().left),\n      y: e.nativeEvent.y - Math.round(e.currentTarget.getBoundingClientRect().top)\n    });\n  };\n\n  const onMouseClickInside = e => {\n    console.log(`Click at ${e.nativeEvent.offsetX}, ${e.nativeEvent.offsetY}`);\n  }; // calculate the candle width\n\n\n  const candle_width = Math.floor(chart_width / data.length * 0.7);\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: chart_width * 1.025\n    /* Extra width to fit price */\n    ,\n    height: chart_height,\n    className: \"chart\",\n    onMouseMove: onMouseMoveInside,\n    onClick: onMouseClickInside,\n    onMouseLeave: onMouseLeave,\n    children: [data.map((bar, i) => {\n      const candle_x = chart_width / (data.length + 1) * (i + 1);\n      return /*#__PURE__*/_jsxDEV(Candle, {\n        data: bar,\n        x: candle_x,\n        candle_width: candle_width,\n        pixelFor: pixelFor\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this);\n    }), /*#__PURE__*/_jsxDEV(CrossHairs, {\n      x: mouseCoords.x,\n      y: mouseCoords.y,\n      chart_dims: chart_dims\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"rect\", {\n      x: chart_width * 1.025 - (1 + dollarAt(mouseCoords.y).length) * 10,\n      y: mouseCoords.y - 12,\n      width: (1 + dollarAt(mouseCoords.y).length) * 10,\n      height: \"25\",\n      fill: \"white\",\n      rx: \"9\",\n      ry: \"9\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n      x: 5 + chart_width * 1.025 - (1 + dollarAt(mouseCoords.y).length) * 10,\n      y: mouseCoords.y + 5,\n      fill: \"black\",\n      fontSize: \"15\",\n      children: [\"$\", dollarAt(mouseCoords.y)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n      x: \"16\",\n      y: \"30\",\n      fontSize: \"20\",\n      children: [/*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"grey\",\n        children: \"Open\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"white\",\n        children: [\"$\", candleDataAt(mouseCoords.x)['open'], \"  \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 41\n      }, this), /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"grey\",\n        children: \"High\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"white\",\n        children: [\"$\", candleDataAt(mouseCoords.x)['high']]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 41\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n      x: \"16\",\n      y: \"54\",\n      fontSize: \"20\",\n      children: [/*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"grey\",\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"white\",\n        children: [\"$\", candleDataAt(mouseCoords.x)['close'], \"  \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 42\n      }, this), /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"grey\",\n        children: \"Low\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"white\",\n        children: [\"$\", candleDataAt(mouseCoords.x)['low']]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 40\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n      x: \"16\",\n      y: \"76\",\n      fontSize: \"20\",\n      children: [/*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"grey\",\n        children: \"Volume\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"white\",\n        children: [mouseCoords.x > 0 ? (candleDataAt(mouseCoords.x)['volume'] / 1000).toFixed(2) + 'K' : '', \"  \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 43\n      }, this), /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"grey\",\n        children: \"Change\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"tspan\", {\n        fill: \"white\",\n        children: candleChange(mouseCoords.x)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 43\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n      x: \"16\",\n      y: \"110\",\n      fill: \"white\",\n      fontSize: \"30\",\n      children: [candleDataAt(mouseCoords.x)['xAxis'], \" \", mouseCoords.x > 0 ? 'EST' : '']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Chart, \"Zirphik+dq5A1HSKq0DCW4tQD+A=\");\n\n_c = Chart;\nexport default Chart;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chart\");","map":{"version":3,"sources":["/Users/benjaminshiao/Desktop/react/trade-analyzer/src/components/chart-components/Chart.js"],"names":["React","useState","Candle","CrossHairs","Chart","props","data","width","chart_width","height","chart_height","mouseCoords","setMouseCoords","x","y","dollar_high","Math","max","apply","map","bar","high","dollar_low","min","low","console","log","sort","chart_dims","pixel_width","pixel_height","dollar_delta","dollarAt","pixel","dollar","abs","toFixed","candleDataAt","candle","floor","length","candleChange","change","posNeg","pixelFor","onMouseLeave","onMouseMoveInside","e","nativeEvent","round","currentTarget","getBoundingClientRect","left","top","onMouseClickInside","offsetX","offsetY","candle_width","i","candle_x"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\n\nimport Candle from \"./Candle\";\nimport CrossHairs from \"./CrossHairs\";\n\nconst Chart = props => {\n  const { data, width: chart_width, height: chart_height } = props;\n  // let { last_bar_idx = 0, bars_wide = 40 } = props;\n\n  // last_bar_idx should default to the last bar in the data, or else be sure passed-in value doesn't exceed the last bar\n  // last_bar_idx = last_bar_idx > 0 ? Math.min(last_bar_idx, data.length - 1) : data.length - 1;\n\n  const [mouseCoords, setMouseCoords] = useState({\n    x: -50,\n    y: -50\n  });\n\n  // let mouseCoords = {\n  //   x: 0,\n  //   y: 0\n  // };\n\n  // const setMouseCoords = (x, y) => {\n  //   mouseCoords = { x, y };\n  // };\n\n\n/*\n\n  const dollar_high = Math.max.apply(Math, data.map(bar => bar.high)) * 1;\n  const dollar_low = +data.map(bar => bar.low).sort()[0];\n  console.log(dollar_low, dollar_high, data.map(bar => bar.low).sort());\n*/\n\n  // find the high and low bounds of all the bars being sidplayed\n  const dollar_high = Math.max.apply(Math, data.map(bar => +bar.high)) * 1.5;\n  const dollar_low = Math.min.apply(Math, data.map(bar => +bar.low)) * 0.5 ;\n  console.log(dollar_low, dollar_high, data.map(bar => +bar.low).sort());\n\n\n\n  const chart_dims = {\n    pixel_width: chart_width,\n    pixel_height: chart_height,\n    dollar_high,\n    dollar_low,\n    dollar_delta: dollar_high - dollar_low\n  };\n\n  // toFixed rounds number to 2 decimal places\n  const dollarAt = pixel => {\n    const dollar =\n      (Math.abs(pixel - chart_dims.pixel_height) / chart_dims.pixel_height) *\n        chart_dims.dollar_delta +\n      chart_dims.dollar_low;\n\n    return pixel > 0 ? dollar.toFixed(2) : \"-\";\n  };\n\n  // Gets candlestick data at x position\n  const candleDataAt = pixel => {\n    if(pixel<=0 || pixel >= chart_dims.pixel_width) return \"-\";\n    const candle = data[Math.floor((pixel/ chart_dims.pixel_width) * data.length)];\n\n    return candle;\n  };\n\n  const candleChange = pixel => {\n    if(pixel<=0 || pixel >= chart_dims.pixel_width) return \"-\";\n    const candle = data[Math.floor((pixel/ chart_dims.pixel_width) * data.length)];\n    const change = ((candle['close']/candle['open'])-1) * 100;\n    const posNeg = change > 0 ? '+' : '-';\n    return posNeg + Math.abs(change).toFixed(2) + '%';\n  };\n\n  const pixelFor = dollar => {\n    return Math.abs(\n      ((dollar - chart_dims[\"dollar_low\"]) / chart_dims[\"dollar_delta\"]) *\n        chart_dims[\"pixel_height\"] -\n        chart_dims[\"pixel_height\"]\n    );\n  };\n\n  const onMouseLeave = () => {\n    setMouseCoords({\n      x: -50,\n      y: -50\n    });\n  };\n\n  const onMouseMoveInside = e => {\n    //for date(x axis), calc using dates[x cord/width] , create dates[]\n    setMouseCoords({\n      x:\n        e.nativeEvent.x -\n        Math.round(e.currentTarget.getBoundingClientRect().left),\n      y:\n        e.nativeEvent.y -\n        Math.round(e.currentTarget.getBoundingClientRect().top)\n    });\n  };\n\n  const onMouseClickInside = e => {\n    console.log(`Click at ${e.nativeEvent.offsetX}, ${e.nativeEvent.offsetY}`);\n  };\n\n  // calculate the candle width\n  const candle_width = Math.floor((chart_width / data.length) * 0.7);\n  return (\n    <svg\n      width={chart_width*1.025 /* Extra width to fit price */}\n      height={chart_height}\n      className=\"chart\"\n      onMouseMove={onMouseMoveInside}\n      onClick={onMouseClickInside}\n      onMouseLeave={onMouseLeave}\n    >\n      {data.map((bar, i) => {\n        const candle_x = (chart_width / (data.length + 1)) * (i + 1);\n        return (\n          <Candle\n            key={i}\n            data={bar}\n            x={candle_x}\n            candle_width={candle_width}\n            pixelFor={pixelFor}\n          />\n        );\n      })}\n\n      <CrossHairs x={mouseCoords.x} y={mouseCoords.y} chart_dims={chart_dims} />\n      \n      {/* Price */}\n      <rect x={(chart_width*1.025)-(1+dollarAt(mouseCoords.y).length)*10} y={mouseCoords.y-12} width={(1+dollarAt(mouseCoords.y).length)*10} height='25' fill=\"white\" rx='9' ry='9'>{/* background color for price */}</rect>\n      <text x={5 + (chart_width*1.025)-(1+dollarAt(mouseCoords.y).length)*10} y={mouseCoords.y+5} fill='black' fontSize=\"15\">\n        ${dollarAt(mouseCoords.y)}\n      </text>\n      {/* Open/High */}\n      <text x='16' y='30' fontSize=\"20\">\n        <tspan fill='grey'>Open</tspan> <tspan fill='white'>${candleDataAt(mouseCoords.x)['open']}  </tspan>\n        <tspan fill='grey'>High</tspan> <tspan fill='white'>${candleDataAt(mouseCoords.x)['high']}</tspan>\n      </text>\n      {/* Low/Close */}\n      <text x='16' y='54' fontSize=\"20\">\n        <tspan fill='grey'>Close</tspan> <tspan fill='white'>${candleDataAt(mouseCoords.x)['close']}  </tspan>\n        <tspan fill='grey'>Low</tspan> <tspan fill='white'>${candleDataAt(mouseCoords.x)['low']}</tspan>\n      </text>\n      {/* Volume/%change */}\n      <text x='16' y='76' fontSize=\"20\">\n        <tspan fill='grey'>Volume</tspan> <tspan fill='white'>{mouseCoords.x > 0 ?(candleDataAt(mouseCoords.x)['volume']/1000).toFixed(2) + 'K': ''}  </tspan>\n        <tspan fill='grey'>Change</tspan> <tspan fill='white'>{candleChange(mouseCoords.x)}</tspan>\n      </text>\n      {/* Date Time */}\n      <text x='16' y='110' fill='white' fontSize='30'>\n        {candleDataAt(mouseCoords.x)['xAxis']} {mouseCoords.x > 0 ? 'EST' : ''} \n      </text>\n    </svg>\n  );\n};\n\nexport default Chart;\n"]},"metadata":{},"sourceType":"module"}